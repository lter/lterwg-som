layer_bot_max = max(layer_bot, na.rm=T),
land_cover = first(land_cover)) #max depth is a random effect
#Join the horizon-specific profile sums to the covariate table
somNEONMegaSoil.withRoot.Profile.hzn.stats <- somNEONMegaSoil.withRoot.Profile.hzn %>%
left_join(somNEONMegaSoilRootCovariates.hzn, by=c("site_code", "hzn_type"))
#split the dataframes
somNEON_organic_wholeprofile <- filter(somNEONMegaSoil.withRoot.Profile.hzn.stats, hzn_type=="organic")
somNEON_mineral_wholeprofile <- filter(somNEONMegaSoil.withRoot.Profile.hzn.stats, hzn_type=="mineral")
#Figure 2
fig2_landcov <- ggplot(data=somNEON_organic_wholeprofile, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(aes(fill=land_cover), pch=21, size=3)+
xlab(bquote(Organic-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Organic-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=2, title.theme = element_text(size=12, angle=0), label.theme = element_text(size=12, angle=0)))+
theme(legend.position=c(0.3,0.85), legend.box.background = element_rect(color = "black"), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=14),axis.text.x=element_text(size=12),axis.text.y=element_text(size=12))
fig2_landcov
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(color = hzn_type))+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_color_manual(values=c("orangered3","navyblue"))+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(color=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21)+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_fill_manual(values=c("orangered3","navyblue"))+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21)+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_fill_manual(values=c("orangered3","navyblue"))+
scale_color_manual(values=c("orangered3","navyblue"))+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21)+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_fill_manual(values=c("orangered3","navyblue"))+
scale_color_manual(values=c("orangered3","navyblue"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_fill_manual(values=c("orangered3","navyblue"))+
scale_color_manual(values=c("orangered3","navyblue"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
geom_smooth(method=lm, aes(color=hzn_type))+
scale_fill_manual(values=c("black","gray"))+
scale_color_manual(values=c("black","gray"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
geom_smooth(method=lm, aes(color=hzn_type, fill = hzn_type))+
scale_fill_manual(values=c("black","gray"))+
scale_color_manual(values=c("black","gray"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
geom_smooth(method=lm, aes(color=hzn_type), alpha=0.7)+
scale_fill_manual(values=c("black","gray"))+
scale_color_manual(values=c("black","gray"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, aes(color=hzn_type), alpha=0.7)+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
scale_fill_manual(values=c("black","gray"))+
scale_color_manual(values=c("black","gray"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
#Figure 2
fig3_hzn <- ggplot(data=somNEONMegaSoil.withRoot.Profile.hzn.stats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, aes(color=hzn_type), alpha=0.3)+
geom_point(aes(fill = hzn_type), pch=21, size=4)+
scale_fill_manual(values=c("black","gray"))+
scale_color_manual(values=c("black","gray"), guide="none")+
xlab(bquote(Root~biomass~(kg~C~m^-2)))+
ylab(bquote(Soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Horizon", title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.85,0.85), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text.x=element_text(size=14),axis.text.y=element_text(size=14))
fig3_hzn
ggsave(plot=fig3_hzn, filename="Fig2_hzn_SOC_bgb.jpeg", dpi=300)
#organic horizon model selection
reduced.mod.org<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum +  mat + map + clay + (1|layer_bot_max)) # removed land cover as a fixed effect
summary(full.mod.org)
summary(reduced.mod.org)
Anova(full.mod.org)
r2(full.mod.org)
Anova(reduced.mod.org)
r2(reduced.mod.org)
#organic horizon model selection
null.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ (1|layer_bot_max))
full.mod.org<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum +  mat + map + clay + (1|layer_bot_max)) # removed land cover as a fixed effect
full.mod.org<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum +  mat + map + clay +land_cover + (1|layer_bot_max)) # removed land cover as a fixed effect
View(somNEONMegaSoilRootCovariates.hzn)
View(somNEONMegaSoil.withRoot.Profile.hzn.stats)
#Grab covariates
somNEONMegaSoilRootCovariates.hzn <- somNEONMegaSoil.withRoot %>%
group_by(site_code, hzn_type) %>%
summarize(mat = mean(mat, na.rm = T),
map = mean(map, na.rm = T),
clay = mean(clay, na.rm=T), #clay is averaged across the whole profile
layer_bot_max = max(layer_bot, na.rm=T)) #max depth is a random effect
#Join the horizon-specific profile sums to the covariate table
somNEONMegaSoil.withRoot.Profile.hzn.stats <- somNEONMegaSoil.withRoot.Profile.hzn %>%
left_join(somNEONMegaSoilRootCovariates.hzn, by=c("site_code", "hzn_type"))
#split the dataframes
somNEON_organic_wholeprofile <- filter(somNEONMegaSoil.withRoot.Profile.hzn.stats, hzn_type=="organic")
somNEON_mineral_wholeprofile <- filter(somNEONMegaSoil.withRoot.Profile.hzn.stats, hzn_type=="mineral")
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + mat + map + clay + land_cover + (1|layer_bot_max))
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + (1|layer_bot_max)) #mat + map + clay +
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + clay + (1|layer_bot_max)) #mat + map + clay +
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + clay + mat +(1|layer_bot_max)) #mat + map + clay +
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + clay + mat + map +(1|layer_bot_max)) #mat + map + clay +
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + clay + mat  +(1|layer_bot_max)) #mat + map + clay +
AIC(full.mod)
performance::r2(full.mod)
reducded.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
land_cover + clay + mat +(1|layer_bot_max))
summary(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
land_cover + clay + mat +(1|layer_bot_max))
Anova(reduced.mod)
AIC(full.mod)
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
land_cover + clay +(1|layer_bot_max))
summary(reduced.mod)
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
land_cover  +(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat + clay  +(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
clay  +(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat  +(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ mat +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ clay +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ map +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ land_cover +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
vif(full.mod)
car::vif(full.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + mat +land_cover +
(1|layer_bot_max))
AIC(reduced.mod)
performance::r2(reduced.mod)
AICc(reduced.mod)
performance::aicc(reduced.mod)
performance_aicc(reduced.mod)
performance::performance_aicc(reduced.mod)
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + clay + mat  +(1|layer_bot_max)) #map has been omitted because the model kept failing to converge
performance::performance_aicc(full.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ mat + clay +
land_cover + (1|layer_bot_max))
performance::performance_aicc(full.mod)
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_su + clay +
land_cover + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + clay +
land_cover + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + mat +
land_cover + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
land_cover + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat + clay + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
clay + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat + (1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ mat +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ clay +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ map +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ clay +  land_cover +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ land_cover +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
View(somNEONMegaSoilRootSelSumDepth)
write.csv(somNEONMegaSoilRootSelSumDepth, "somNEONMegaSoilRootSelSumDepth.csv")
somNEONMegaRootsSelSumDepth$rootfrac_cumsum
beta.all<-read.csv("beta.all_022720.csv")
beta.all$beta_roots[beta.all$land_cover=="forest"]
beta.all$beta_soc[beta.all$land_cover=="forest"]
View(somNEONMegaSoil.withRoot.Profile.hzn.stats)
write.csv(somNEONMegaSoil.withRoot.Profile.hzn.stats, "Fig2_horizon_df.csv")
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ clay + land_cover +
(1|layer_bot_max))
#Organic horizon models
null.mod <- lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ (1|layer_bot_max))
car::Anova(null.mod, reduced.mod)
Anova(null.mod, reduced.mod)
aov(null.mod, reduced.mod)
Anova(reduced.mod)
Anova(reduced.mod, null.mod)
anova(reduced.mod, null.mod)
aov(reduced.mod, null.mod)
summary(reduced.mod)
Anova(reduced.mod
Anova(reduced.mod)
Anova(reduced.mod)
summary(reduced.mod)
anova(reduced.mod, full.mod)
performance::r2(reduced.mod)
View(somNEONMegaSoil.withRoot.Profile.hzn.stats)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ land_cover +
(1|layer_bot_max))
anova(full.mod)
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover  + mat  +(1|layer_bot_max)) #map has been omitted because the model kept failing to converge
AIC(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ land_cover +
(1|layer_bot_max))
anova(reduced.mod)
performance::performance_aicc(full.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ mat +land_cover +
(1|layer_bot_max))
performance::performance_aicc(full.mod)
performance::performance_aicc(reduced.mod)
performance::r2(full.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ land_cover +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + land_cover +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
performance::r2(reduced.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + mat +
(1|layer_bot_max))
performance::performance_aicc(reduced.mod)
performance::r2(reduced.mod)
full.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + land_cover + mat + map +(1|layer_bot_max)) #map has been omitted because the model kept failing to converge
performance::performance_aicc(reduced.mod)
performance::r2(reduced.mod)
performance::performance_aicc(full.mod)
performance::r2(full.mod)
reduced.mod<-lmer(data=somNEON_organic_wholeprofile, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum + mat + land_cover +
(1|layer_bot_max))
anova(reduced.mod)
summary(reduced.mod)
anova(reduced.mod)
Anova(reduced.mod)
anova(reduced.mod, null.mod)
performance::r2(reduced.mod)
View(somNEONMegaRootsSelSumDepth)
beta.all$beta_roots[beta.all$land_cover=="rangeland/grassland"]
names(somNEONMegaSoilRoot_wholeprofilestats)
#remove the three high root outliers
somNEONMegaSoilRoot_wholeprofilestats_noshrubNoOut <-somNEONMegaSoilRoot_wholeprofilestats %>%
filter(bgb_c_stock_sum<1.5)
#remove the three high root outliers
somNEONMegaSoilRoot_wholeprofilestats_NoOut <-somNEONMegaSoilRoot_wholeprofilestats %>%
filter(bgb_c_stock_sum<1.5)
#Reduced model, dropping MAP because it is not significant, making land_cover a random effect
reduced.mod2<-lmer(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~
mat + clay + land_cover + bgb_c_stock_sum + (1|layer_bot_max)) # removed land cover as a fixed effect
write.csv(somNEONMegaSoilRoot_wholeprofilestats, "whole_profile_stats.csv")
View(somNEONMegaSoilRoot_wholeprofilestats)
#Reduced model, dropping MAP because it is not significant, making land_cover a random effect
reduced.mod2<-lmer(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~
mat + clay + land_cover + bgb_c_stock_sum + (1|layer_bot_max)) # removed land cover as a fixed effect
#Reduced model, dropping MAP because it is not significant, making land_cover a random effect
reduced.mod2<-lmer(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + mat + clay + land_cover + (1|layer_bot_max)) # removed land cover as a fixed effect
#Obj 1b: using a multiple regression instead of mixed model to directly test layer_bot_max effect
mod<-lm(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat + clay + land_cover + layer_bot_max)
str(somNEONMegaSoilRoot_wholeprofilestats_NoOut)
#Obj 1b: using a multiple regression instead of mixed model to directly test layer_bot_max effect
mod<-lm(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum +
mat + clay + land_cover)
#Obj 1b: using a multiple regression instead of mixed model to directly test layer_bot_max effect
mod<-lm(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~ bgb_c_stock_sum)
View(somNEONMegaSoilRoot_wholeprofilestats_NoOut)
#remove the three high root outliers
somNEONMegaSoilRoot_wholeprofilestats_NoOut <-somNEONMegaSoilRoot_wholeprofilestats %>%
filter(!site_code==c("HEAL","BARR","WREF"))
#remove the three high root outliers
somNEONMegaSoilRoot_wholeprofilestats_NoOut <-somNEONMegaSoilRoot_wholeprofilestats %>%
filter(!site_code %in% c("HEAL","BARR","WREF"))
View(somNEONMegaSoilRoot_wholeprofilestats_NoOut)
#Reduced model, dropping MAP because it is not significant, making land_cover a random effect
reduced.mod2<-lmer(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~
bgb_c_stock_sum + mat + clay + land_cover + (1|layer_bot_max))
Anova(reduced.mod2)
summary(reduced.mod2)
performance::r2(reduced.mod)
performance::r2(reduced.mod2)
#### AVNI'S AGU TALK
### Results for Objective 1: Whole profile summed SOC correlated with Roots (whole profile summed) and other covariates
null.mod <- lmer(data=somNEONMegaSoilRoot_wholeprofilestats_NoOut, lyr_soc_stock_calc_sum ~ (1|layer_bot_max))
Anova(null.mod, reduced.mod2)
anova(null.mod, reduced.mod2)
performance::r2(reduced.mod2)
names(somNEONMegaSoilRoot_wholeprofilestats)
levels(somNEONMegaSoilRoot_wholeprofilestats$eco_region)
names(somNEONMegaSoil.withRoot)
levels(somNEONMegaSoil.withRoot$eco_region)
levels(somNEONMegaSoil.withRoot$eco_type)
fig1_landcov <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=19, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
#scale_fill_manual(values=c("orchid", "springgreen3","coral","dodgerblue"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=2, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.75,0.1), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_landcov
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
#scale_fill_manual(values=c("orchid", "springgreen3","coral","dodgerblue"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=2, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position=c(0.75,0.1), panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
#scale_fill_manual(values=c("orchid", "springgreen3","coral","dodgerblue"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","springgreen4","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","olivedrab","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","orangered3","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","orangered","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","orangered4","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","sienna4","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","red","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","burntorange","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
fig1_ecoreg <- ggplot(data=somNEONMegaSoilRoot_wholeprofilestats, aes(x=bgb_c_stock_sum/1000, y=lyr_soc_stock_calc_sum/1000))+
geom_smooth(method=lm, color="black")+
geom_point(pch=21, size=3, aes(fill = eco_region))+ # alternatively, add aes(fill=land_cover)
scale_fill_manual(values=c("darkgreen","tan4","springgreen1","sienna3","tan","dodgerblue","gray"))+
xlab(bquote(Whole-profile~root~biomass~(kg~C~m^-2)))+
ylab(bquote(Whole-profile~soil~organic~C~(kg~C~m^-2)))+
guides(fill=guide_legend(title="Land Cover", ncol=1, title.theme = element_text(size=14, angle=0), label.theme = element_text(size=14, angle=0)))+
theme(legend.position="right", panel.grid.major=element_blank(),panel.grid.minor=element_blank(),panel.border=element_rect(fill=NA, color="black"),panel.background=element_rect(fill="white"),axis.title=element_text(size=16),axis.text=element_text(size=14))
fig1_ecoreg
ggsave(plot=fig1_landcov, filename="Fig1_wholeprof_ecoregion.jpeg", dpi=300)
ggsave(plot=fig1_ecoreg, filename="Fig1_wholeprof_ecoregion.jpeg", dpi=300)
